{"version":3,"file":"gnss.js","sources":["../src/event-emitter.js","../src/index.js"],"sourcesContent":["/**\n * EventEmitter - Simple event system for component communication\n */\nexport class EventEmitter {\n  constructor() {\n    this.events = {};\n    this.debugMode = false;\n  }\n\n  /**\n   * Subscribe to an event\n   * @param {string} event - Event name\n   * @param {Function} listener - Callback function\n   * @returns {Function} Unsubscribe function\n   */\n  on(event, listener) {\n    if (!this.events[event]) {\n      this.events[event] = [];\n    }\n    \n    this.events[event].push(listener);\n    \n    // Return unsubscribe function\n    return () => {\n      this.events[event] = this.events[event].filter(l => l !== listener);\n    };\n  }\n  \n  /**\n   * Modern DOM-style event subscription (alias for on)\n   * @param {string} event - Event name\n   * @param {Function} listener - Callback function\n   */\n  addEventListener(event, listener) {\n    return this.on(event, listener);\n  }\n\n  /**\n   * Subscribe to an event once\n   * @param {string} event - Event name\n   * @param {Function} listener - Callback function\n   */\n  once(event, listener) {\n    const remove = this.on(event, (...args) => {\n      remove();\n      listener(...args);\n    });\n  }\n\n  /**\n   * Emit an event with data\n   * @param {string} event - Event name\n   * @param {*} data - Event data\n   */\n  emit(event, data) {\n    if (this.debugMode) {\n      console.log(`[EventEmitter] ${event}:`, data);\n    }\n    \n    if (this.events[event]) {\n      this.events[event].forEach(listener => {\n        try {\n          listener(data);\n        } catch (error) {\n          console.error(`Error in event listener for '${event}':`, error);\n        }\n      });\n    }\n  }\n\n  /**\n   * Remove a specific listener for an event\n   * @param {string} event - Event name\n   * @param {Function} listener - Callback function to remove\n   */\n  off(event, listener) {\n    if (this.events[event]) {\n      this.events[event] = this.events[event].filter(l => l !== listener);\n    }\n  }\n  \n  /**\n   * Modern DOM-style event unsubscription (alias for off)\n   * @param {string} event - Event name\n   * @param {Function} listener - Callback function to remove\n   */\n  removeEventListener(event, listener) {\n    return this.off(event, listener);\n  }\n  \n  /**\n   * Remove all listeners for an event\n   * @param {string} event - Event name\n   */\n  removeAllListeners(event) {\n    if (event) {\n      delete this.events[event];\n    } else {\n      this.events = {};\n    }\n  }\n\n  /**\n   * Enable/disable debug mode\n   * @param {boolean} enabled - Whether debug mode is enabled\n   */\n  setDebug(enabled) {\n    this.debugMode = enabled;\n  }\n}\n\n// For backward compatibility\nexport default EventEmitter;","/**\n * GNSS Module - Main entry point\n * \n * This module provides a JavaScript interface for connecting to GNSS RTK rovers\n * via Web Bluetooth or Web Serial, parsing NMEA data, and managing NTRIP correction data.\n */\nimport { EventEmitter } from './event-emitter.js';\n\n/**\n * Main GNSS Module class\n * Manages device connections, NMEA parsing, and NTRIP client\n */\nclass GnssModule {\n  /**\n   * Create a new GNSS module instance\n   * @param {Object} options - Configuration options\n   */\n  constructor(options = {}) {\n    // Initialize event system\n    this.events = new EventEmitter();\n    \n    // Initialize other properties\n    this.debugSettings = options.debugSettings || {\n      info: false,\n      debug: false,\n      errors: true,\n      parsedSentences: false,\n      rtcmMessages: false\n    };\n    \n    // Last known position\n    this.currentPosition = null;\n  }\n  \n  /**\n   * Set up internal event listeners\n   * @private\n   */\n  _setupEventListeners() {\n    // To be implemented as components are added\n  }\n  \n  /**\n   * Connect to a GNSS device using available methods\n   * @param {Object} options - Connection options\n   * @returns {Promise<boolean>} Connection success\n   */\n  async connectDevice(options = {}) {\n    console.log('connectDevice not yet implemented');\n    return false;\n  }\n  \n  /**\n   * Connect to NTRIP caster\n   * @param {Object} options - Connection options\n   * @returns {Promise<boolean>} Connection success\n   */\n  async connectNtrip(options = {}) {\n    console.log('connectNtrip not yet implemented');\n    return false;\n  }\n  \n  /**\n   * Disconnect from device\n   * @returns {Promise<void>}\n   */\n  async disconnectDevice() {\n    console.log('disconnectDevice not yet implemented');\n  }\n  \n  /**\n   * Disconnect from NTRIP\n   * @returns {Promise<void>}\n   */\n  async disconnectNtrip() {\n    console.log('disconnectNtrip not yet implemented');\n  }\n  \n  /**\n   * Get current position\n   * @returns {Object|null} Current position\n   */\n  getPosition() {\n    return this.currentPosition;\n  }\n  \n  /**\n   * Get satellite information\n   * @returns {Array|null} Satellite information\n   */\n  getSatellites() {\n    return [];\n  }\n  \n  /**\n   * Subscribe to an event\n   * @param {string} event - Event name\n   * @param {Function} callback - Callback function\n   * @returns {Function} Unsubscribe function\n   */\n  on(event, callback) {\n    return this.events.on(event, callback);\n  }\n  \n  /**\n   * Unsubscribe from an event\n   * @param {string} event - Event name\n   * @param {Function} callback - Callback function\n   */\n  off(event, callback) {\n    this.events.off(event, callback);\n  }\n}\n\n// Export the main module class\nexport { GnssModule };\n\n// Export EventEmitter for extensibility\nexport { EventEmitter };\n\n// Export default GnssModule for backward compatibility\nexport default GnssModule;"],"names":[],"mappings":"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"}